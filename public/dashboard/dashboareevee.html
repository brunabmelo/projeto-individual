<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="shortcut icon" href="../assets/icon/favicon2.ico" type="image/x-icon">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Eevee | Cuidados</title>


    <link rel="stylesheet" href="./../css/dashboards.css">

    <script src="../js/sessao.js"></script>
    <script src="../js/alerta.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body onload="obterDados()">

    <!--MENU SITE-->
    <div class="janela">
        <div class="header-left">
            <a href="./dashboard.html">
                <img src="../assets/logo/iconLogo-1.png" class="logo">
            </a>

            <div class="hello">
                <h3>Olá, <span id="b_usuario">usuário</span>!</h3>
            </div>

            <div class="btn-nav-white">
                <a href="./cards.html">
                    <h3>Meu Eevee</h3>
                </a>
            </div>

            <div class="btn-nav">

                <h3>Gráficos</h3>

            </div>

            <div class="btn-nav-white">
                <a href="./perfil.html">
                    <h3>Perfil</h3>
                </a>
            </div>

            <div class="btn-logout" onclick="limparSessao()">
                <h3>Sair</h3>
            </div>

        </div>
        <!--FINAL MENU -->

        <!-- GRAFICO -->
         <button onclick="grafico()">quero dados</button>
         <div id="id_dodiv"></div>
        <canvas id="linha"></canvas>

        <canvas id="pizza"></canvas>

    </div>

    </div>

</body>
<script>



    b_usuario.innerHTML = sessionStorage.NOME_USUARIO;

    function obterDados() {

        /*       fetch('/obterDados')
         .then(function(response){
       return response.json();
        })
         .then(function(data){
            plotarGraficoLinha(data);
           plotarGraficoBarra(data);
          })
         .catch(function(err){
            console.log(err);
          })*/

        var dados = [{
            jogador: 'Endrick',
            votos: 10
        },
        {
            jogador: 'João',
            votos: 5
        },
        {
            jogador: 'Maria',
            votos: 15
        },
        {
            jogador: 'José',
            votos: 20
        },
        {
            jogador: 'Pedro',
            votos: 25
        },
        {
            jogador: 'Ana',
            votos: 30
        }]

        plotarGraficoLinha(dados);

        plotarGraficoBarra(dados)
    }

    function plotarGraficoLinha(dados){
        var votos = [];
  var jogadores = [];

   // Preenchendo os arrays com os dados
    for(var i = 0; i < dados.length; i++){
    votos.push(dados[i].votos);
    jogadores.push(dados[i].jogador);
  }

    // Capturando o elemento canvas pelo id 
  var ctx = document.getElementById('pizza').getContext('2d');
  var myChart = new Chart(ctx, {
      type: 'pie', // Tipo de gráfico: linha
      data: { // Dados para o gráfico
          labels: jogadores, // Rótulos no eixo X
          datasets: [{ 
              label: 'Votos', // Nome do conjunto de dados
              data: votos, // Dados dos votos
              backgroundColor: [
                  'rgba(255, 99, 132, 0.2)', // Cor de fundo das linhas
              ],
              borderColor: [
                  'rgba(255, 99, 132, 1)', // Cor da borda das linhas
              ],
              borderWidth: 1 // Largura da borda das linhas
          }]
      },
  });
} 


    async function grafico() {
const resp = await fetch("/grafico/grafico");
const dados= await resp.json;
    console.log(dados)
    id_dodiv.innerHTML=`${dados}`

}


</script>

</html>